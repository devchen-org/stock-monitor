# 股票持仓收益实时监控程序

## 功能特点

- 💻 在命令行中运行（方便上班时盯盘）
- 📊 实时获取股票最新价格
- 💰 自动计算盈亏额和盈亏率
- 📈 显示总持仓市值和总盈亏
- ⚡ 支持定时自动刷新
- 📲 支持企业微信机器人发送表格
- 🔧 配置简单，无需API密钥
- 🚀 PHP 8编写，无需额外依赖

## 环境要求

- PHP 8.0 或更高版本

## 快速开始

### 1. 配置持仓

编辑 `stocks_config.txt` 文件，每行一只股票：

```
股票代码|持仓数量|买入价格
```

示例：
```
sh600519|100|1500.00
sh601318|200|45.00
```

### 2. 运行程序

```bash
php stock_monitor.php
```

### 3. 配置自动刷新（可选）

在 `stocks_config.txt` 中添加：
```
interval = 20  # 刷新间隔（秒）
```


### 4. 配置是否只在交易时间刷新 （true/false）（可选）

在 `stocks_config.txt` 中添加：
```
trading_time = true  # 是否只在交易时间刷新 （true/false）
```

### 5. 配置企业微信机器人（可选）

在 `stocks_config.txt` 中添加：
```
wechat_webhook = https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxxxx
```

### 6. 配置买入和卖出手数用于计算买x手后成本价、卖x手后成本价（可选）

在 `stocks_config.txt` 中添加：
```
buy_lots = 2  # 买入手数
sell_lots = 1  # 卖出手数
```

## 显示说明

终端显示：
- 代码、名称、涨跌、涨跌幅、最高价、最低价、现价、成本价、买x手后成本价、卖x手后成本价、持仓、市值、盈亏额、盈亏率
- 总持仓市值和总盈亏汇总

企业微信显示：
- 名称、涨跌、涨跌幅、现价、成本价

## 注意事项

- 股票代码前缀：上交所（sh）、深交所（sz）

## 快捷键

- `Ctrl+C`：退出程序

## 运行效果

### 终端显示

```
股票持仓收益实时监控 - 2026-01-18 10:00:00

+--------------+----------------+----------+----------+----------+----------+----------+----------+------------+----------------+----------------+--------------+----------------+----------------+
| 代码         | 名称           | 涨跌     | 涨跌幅   | 最高价   | 最低价   | 现价     | 成本价   | 买2手后成本价 | 卖1手后成本价 | 持仓       | 市值           | 盈亏额         | 盈亏率       |
+--------------+----------------+----------+----------+----------+----------+----------+----------+------------+----------------+----------------+--------------+----------------+----------------+
| sh600519     | 贵州茅台       | +5.00    | +1.20%   | 1800.00  | 1780.00  | 1795.00  | 1780.00  | 1785.00     | 1780.00        | 100        | 179,500.00     | +1,500.00      | 0.84%        |
| sh601318     | 中国平安       | -0.50    | -1.00%   | 50.50    | 49.50    | 49.50    | 50.00    | 49.80       | 50.00          | 200        | 9,900.00       | -100.00        | -1.00%       |
+--------------+----------------+----------+----------+----------+----------+----------+----------+------------+----------------+----------------+--------------+----------------+----------------+
|              |                |          |          |          |          |          |          |            |                | 总计 (2只) |                | +1,400.00      | 0.76%        |
+--------------+----------------+----------+----------+----------+----------+----------+----------+------------+----------------+----------------+--------------+----------------+----------------+

  盈利: +1,400.00 (0.76%)
  已发送表格到企业微信
 下次刷新: 20秒
```

### 企业微信显示

```
股票持仓收益实时监控 - 2026-01-18 10:00:00

+----------------+----------+----------+----------+----------+
| 名称           | 涨跌     | 涨跌幅   | 现价     | 成本价   |
+----------------+----------+----------+----------+----------+
| 贵州茅台       | +5.00    | +1.20%   | 1795.00  | 1780.00  |
| 中国平安       | -0.50    | -1.00%   | 49.50    | 50.00    |
+----------------+----------+----------+----------+----------+
```

